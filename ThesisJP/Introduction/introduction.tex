\section{Motivation}
A rapid development in computer game technology and accompanying programming languages have recently provided researchers with small personal super computers, comprised in a single graphics card (\nom{GPU}{Graphics Processing Unit}). The latest graphics cards\footnote{As of January 2014} from both \nom{Nvidia}{Graphics card producer} and \nom{AMD}{Graphics card producer} provides close to 6 T\nom{FLOPS}{Floating point operations per second} single precision and 1.5 TFLOPS double precision. For double precision this is more than the worlds most powerful supercomputer could provide in 1998.

This immense rise in computational power and programming flexibility gives new possibilities when designing ultrasound imaging systems. Algorithms which previously had to be implemented in hardware for performance reasons can now be implemented in software. And algorithms, either too complicated to implement in hardware, or though to be too computationally heavy for real-time use, becomes realizable. It is clear that high-performance programmable processors, like the GPU, already have and will continue to make future ultrasound imaging systems more flexible, cheaper to produce, and equipped with even more cutting-edge processing.

The Capon beamformer is a good example of an algorithm which has been highly studied for the last decade for the application of medical ultrasound imaging \todo{cite papers}, but where the number of calculations was though to be too much for real time processing. No wonder, to achieve real-time processing for e.g. cardiac ultrasound imaging an effective processing rate of around 100 MFLOPS is required. This number, as explained in Background \ref{sec:adaptbf}, also grows with larger subarrays, more image pixels, and higher framerate requirements.  With modern GPUs these levels of processing are finally available within a single card.

\section{Aims of study}
The overall aim of this study has been to investigate the possibility of utilizing GPUs for advanced processing in an ultrasound imaging system. 

My main focus have been the Capon beamformer, and the problem of making this computationally intense algorithm available for real-time ultrasound imaging (\textbf{Paper\,I} and \textbf{II}). However, two additional methods were also explored. The first is adaptive volume rendering of cardiac ultrasound volumes (\textbf{Paper\,IV}) and the latter is simulation of dense ultrasound pressure fields (\textbf{Paper\,V}). Both share the property of being computationally heavy, but they also consist of many independent computations which is perfect for parallel GPU computing. 

Well on my way into the project, when a real-time Capon beamformer\footnote{The name ''Capon beamformer'' is due to work by J. Capon \todo{add citation} on seismic arrays \todo{Move to background.}} was realized, and loops of images for the first time were processed, new issues where discovered and had to be solved. This led me to a more theoretical study of the Capon beamformer (\textbf{Paper III}), with special attention on how to obtain high lateral resolution while preserving the important shift-invariant property of medical ultrasound imaging. Shift-invariant behavior is crucial if the method is ever to be applied for live scanning. 

%\subsubsection{Accelerate the Capon beamformer to facilitate real time imaging}

%\subsubsection{}

\section{Summary of papers}

\subsection{Paper I}
\textbf{An Optimised GPU Implementation of the MVDR Beamformer for Active Sonar Imaging}\\
J.\:I.\:Buskenes, \textbf{J.\:P.\:\AA{}sen}, C.-I.\:C.\:Nilsen and A.\:Austeng\\
{\it IEEE Transactions on Oceanic Engineering, submitted.}\\\\
The first paper describes in details how the Capon beamformer is mapped to GPU architecture. Even though the paper is written within the field of active \nom{sonar}{SOund Navigation And Ranging (usually under water)} imaging, the depicted implementation is applicable to a vast range of active imaging systems. A similar discussion for cardiac ultrasound imaging can be found in \textbf{Paper VI}.  Active sonar imaging typically differs from medical ultrasound imaging by a lower real-time requirement, element count, center frequency, and relative bandwidth. 

The estimation of the spatial covariance matrix receives special attention in this work. In previous literature on Capon beamforming the matrix inversion has always been regarded as the most computationally complex piece. In this paper we show that estimation of the sample covariance matrix is actually the most complex part when spatial and temporal smoothing is included with common parameters. It is then shown how the arithmetic complexity of this estimation process can be reduced from cubic to square. Finally, we give an in-depth analysis of the arithmetic throughput on multiple platforms. The reported throughput of 1 Mpx/s is, as far as the authors know, enough to provide real-time processing for all known sonar scan sequences.

\subsection{Paper II}
\textbf{Implementing Capon Beamforming on a GPU for Real-Time Cardiac Ultrasound Imaging}\\
\textbf{J.\:P.\:\AA{}sen}, J.\:I.\:Buskenes, C.-I.\:C\:Nilsen, A.\:Austeng and S.\:Holm\\
{\it IEEE Transactions on Ultrasonics, Ferroelectrics, and Frequency Control, vol. 61, no. 1, pp. \todo{add pages}, Jan. 2014.}\\\\
The second paper aims at achieving real-time Capon beamforming for cardiac ultrasound imaging. Such an implementation will facilitates further study of the methods \textit{in vivo} performance in medical ultrasound imaging. In \textbf{Paper I} we explored arrays with no more than 32 elements. A linear array for cardiac ultrasound imaging typically has 64 or more elements. In \textbf{Paper VI}, which is summarized in \textbf{Paper II}, it is shown that our implementation does not reach the level of throughput required for real-time Capon beamforming of cardiac ultrasound. The matrices that has to be inverted becomes to large, and the number frames that needs to be processed per second is to high.

To reduce the matrix size we take, in this paper, advantage of the beamspace version of the Capon beamformer (\nom{BS-Capon}{Beamspace Capon beamforming}), and implement it on the GPU. For parameters previously derived to give similar performance for BS-Capon and element space Capon (\nom{ES-Capon}{Element Space Capon}), we show that real-time BS-Capon beamforming is feasible for cardiac ultrasound imaging.

\subsection{Paper III}
\textbf{Capon Beamforming and Moving Objects - An Analysis of Lateral Shift-Invariance}\\
\textbf{J.\:P.\:\AA{}sen}, A.\:Austeng and S.\:Holm\\
{\it IEEE Transactions on Ultrasonics, Ferroelectrics, and Frequency Control, submitted.}
Summary of paper...

\subsection{Paper IV}
\textbf{Adaptive Volume Rendering of Cardiac 3D Ultrasound Images - Utilizing Blood Pool Statistics}\\
\textbf{J.\:P.\:\AA{}sen}, E.\:Steen, G.\:Kiss, A.\:Thorstensen and S.\:I.\:Rabben\\
{\it Proc. SPIE Medical Imaging 2012, \todo{add pages}.}\\\\
Summary of paper...

\subsection{Paper V}
\textbf{Huygens on Speed: Interactive Simulation of Ultrasound Pressure Fields}\\
\textbf{J.\:P.\:\AA{}sen} and S.\:Holm\\
{\it Proc. IEEE Ultrasonics Symposium 2012 \todo{add pages}.}\\\\
Summary of paper...

\section{Discussion}
The main contributions of this thesis are:
\begin{enumerate}
\item a GPU implementation of the Capon beamformer
\item a GPU implementation of the beamspace Capon beamformer
\item real-time beamspace Capon beamforming for cardiac ultrasound imaging
\item the first investigation of Capon beamforming applied on multiple frames in medical ultrasound imaging (simulated, \textit{in-vitro}, and \textit{in-vivo})
\item an investigation of shift-invariance for the Capon beamformer
\item a method for improved shift-invariance of the Capon beamformer
\item a method for reduced blood-pool noise in volume rendering of cardiac ultrasound volumes
\item a GPU implementation of this adaptive volume rendering method
\item a GPU implementation of simple paint-like simulation tool for rapid visualization ultrasound pressure fields
\item several discussions on how to utilize the GPU for computationally intense algorithms  
\end{enumerate}

Discuss all papers.

Paper1

Paper2
Discuss why cardiac ultrasound is selected and if full Capon will be real-time for other modalities.

Paper3

Paper4

Paper5

\section{Conclusion}

Concluding remarks...

\section{Future work}

All five papers...

\endinput